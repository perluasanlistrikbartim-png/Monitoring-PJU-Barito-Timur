<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‚ö° Login ‚Äì TINJU PJU</title>
<link rel="stylesheet" href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css">
<style>
body {
  font-family: 'Segoe UI', sans-serif;
  background: radial-gradient(circle at center, #000010, #000);
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  overflow: hidden;
  color: #0ff;
}

.login-box {
  width: 340px;
  padding: 25px;
  background: rgba(0, 10, 20, 0.9);
  border-radius: 15px;
  border: 2px solid #00ffff88;
  box-shadow: 0 0 20px #00ffff55;
  position: relative;
  animation: flicker 4s infinite;
}

@keyframes flicker {
  0%, 100% { box-shadow: 0 0 15px #00ffff; }
  50% { box-shadow: 0 0 30px #00ffff; }
}

.login-box::before {
  content: "";
  position: absolute;
  top: -3px; left: -3px; right: -3px; bottom: -3px;
  border-radius: 15px;
  border: 2px solid #00ffff;
  filter: blur(10px);
  opacity: 0.5;
  animation: lightning 3s infinite linear;
}
@keyframes lightning {
  0%, 100% { opacity: 0.5; }
  50% { opacity: 1; }
}

h2 {
  text-align: center;
  color: #00ffff;
  margin-bottom: 15px;
  text-shadow: 0 0 10px #00ffff;
}

input {
  width: 100%;
  padding: 10px;
  margin: 8px 0;
  border-radius: 8px;
  border: 1px solid #00ffff66;
  background: #001122;
  color: #0ff;
  font-size: 15px;
}

button {
  width: 100%;
  padding: 10px;
  background: linear-gradient(90deg, #00ffff, #0077ff);
  border: none;
  border-radius: 8px;
  color: #000;
  font-weight: bold;
  cursor: pointer;
  box-shadow: 0 0 15px #00ffff;
}
button:hover {
  background: linear-gradient(90deg, #0077ff, #00ffff);
  box-shadow: 0 0 25px #00ffff;
}

#msg {
  text-align: center;
  margin-top: 10px;
  font-weight: bold;
  color: #ff6600;
}
</style>
</head>

<body>
<div class="login-box">
  <h2>‚ö° LOGIN TINJU PJU ‚ö°</h2>
  <input type="text" id="username" placeholder="üë§ Username" required>
  <input type="password" id="password" placeholder="üîí Password" required>
  <button id="loginBtn">Login</button>
  <p id="msg"></p>
</div>

<script>
const proxy = "https://broad-queen-be12.perluasanlistrik-bartim.workers.dev/?url=";
const scriptURL = "https://script.google.com/macros/s/AKfycbwcMi_pBDlXeEzS5wxpIuiRmDjvkiwjgR53TmcfhGyi0DcKTSj3sgGXxfmPEpbVhUgg4g/exec";

document.getElementById("loginBtn").addEventListener("click", async () => {
  const username = document.getElementById("username").value.trim();
  const password = document.getElementById("password").value.trim();
  const msg = document.getElementById("msg");

  if (!username || !password) {
    msg.textContent = "‚ö†Ô∏è Lengkapi username dan password!";
    return;
  }

  msg.textContent = "‚ö° Memeriksa login...";

  try {
    const res = await fetch(proxy + scriptURL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        action: "login",
        username: username,
        password: password
      })
    });
    const data = await res.json();

    if (data.status === "success") {
      // Simpan ke localStorage
      localStorage.setItem("petugas", data.nama);
      localStorage.setItem("role", data.role);
      msg.style.color = "#0f0";
      msg.textContent = "‚úÖ Login berhasil!";
      setTimeout(() => (window.location.href = "index.html"), 1200);
    } else {
      msg.textContent = "‚ùå " + data.message;
    }
  } catch (err) {
    msg.textContent = "‚ö†Ô∏è Gagal koneksi server!";
  }
});
</script>
</body>
</html>
